utils:::menuInstallPkgs()
setwd('E:\R')
setwd('E:\\R')
ls
getwd
getwd()
dat <- readcsv('test.csv')
dat <- read.csv('test.csv')
setwd('E:/R/netcharge_smooth')
dat <- read.csv('test.csv')
dat
library(mgcv)
m<-gam(dat$X17~s(dat$X27))
m<-gam(dat[,1]~s(dat[,2]))
summary(m)
plot(dat[,1]~dat[,2])
plot(dat[,1],dat[,2])
m<-gam(dat[,2]~s(dat[,1))
m<-gam(dat[,2]~s(dat[,1]))
summary(m)
plot(m)
plot(m, residuals=T, pch=16)
plot(m, residuals=T, pch=16, xlab='Age', ylab='NetCharge')
plot(m, residuals=T, pch=16, xlab='Age', ylab='NetCharge', col='red)
)
fipgus]r
sdopvgu ae]-gui 
dfp9gu]er-9w8
dfoguaser]gy8wer]09y7e]r9
llll
p#0000
;soiegy'ero
plot(m, residuals=T, pch=16, xlab='Age', ylab='NetCharge')
plot(m)
plot(m, residuals=T, pch=16, xlab='Age', ylab='NetCharge')
m<-gam(dat[,2]~s(dat[,1]))
summary(m)
ct1<-gam(dat[,2]~s(dat[,1]),family=gamma(link=log))
ct1<-gam(dat[,2]~s(dat[,1]),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19)
gam.check(ct1)
plot(fitted(ct1),residuals(ct1))
ct1$sp
sp.vcov(ct1)
plot(ct1,shade=TRUE,seWithMean=TRUE,scale=0)
plot(ct1,residuals=T,shade=TRUE,seWithMean=TRUE,scale=0)
plot(ct1,residuals=T,shade=TRUE,seWithMean=TRUE,scale=1)
plot(ct1,residuals=T,shade=TRUE,seWithMean=TRUE,scale=2)
plot(ct1,residuals=T,shade=TRUE,seWithMean=TRUE,scale=0)
plot(fitted(ct1),residuals(ct1))
plot(ct1,residuals=TRUE,pch=19)
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
ct1
ct1$sp
par(mfrow=c(1,2))
ct1<-gam(dat[,2]~s(dat[,1]),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
dat <- read.csv('netcharge.csv')
ct1<-gam(dat[,2]~s(dat[,1]),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
dat[,1]
dat[,1]>0.5
dat[dat[,1]>0.5,1]
ct1<-gam(dat[,2]~s(dat[,1]),family=Gamma(link=log))X <- dat[dat[,1]>0.5,1]
Y <- dat[dat[,1]>0.5,2]
ct1 <- gam(Y~s(X),family=Gamma(link=log))
X <- dat[dat[,1]>0.5,1]
Y <- dat[dat[,1]>0.5,2]
ct1 <- gam(Y~s(X),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
X <- dat[dat[,1]>0.5,1]
Y <- dat[dat[,1]>0.5,2]
ct1 <- gam(Y~s(X),family=Gamma(link=log))
Y <- dat[dat[,1]>0.5,2]
ct1
smooth
smooth()
smooth
X <- dat[dat[,1]>0,1]
Y <- dat[dat[,1]>0,2]
ct1 <- gam(Y~s(X),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
source("E:\\R\\netcharge_smooth\\smooth.R")
dat <- read.csv('netcharge_ngs10.csv')
X <- dat[dat[,1]>0,1]
Y <- dat[dat[,1]>0,2]
ct1 <- gam(Y~s(X),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
alpha <- c(-Inf,-1,0,5,Inf)
R <- length(alpha)-1
R
alpha
ct1 <- gam(Y~s(X),family=ocat(R=7))
X
Y
length(X)
length(Y)
min(Y)
max(Y)
ct1 <- gam(Y~s(X),family=Gamma(link=log))
ct1 <- gam(Y~s(X),family=ocat(R=7))
ct1 <- gam(Y~s(X),family=ocat(R=6))
ct1 <- gam(Y~s(X),family=ocat(R=8))
ct1 <- gam(Y~s(X),family=ocat(R=7))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=NULL))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=3))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=4))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=5))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=6))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=7))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=8))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=10))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=1))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=100))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=12))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=15))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=25))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=20))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=10))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=20))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=3.5))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=3.6))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=3))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=2))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=4))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=15))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=16))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=17))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=18))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=19))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=20))
dat <- read.csv('titres.csv')
X <- dat[dat[,1]>0,1]
Y <- dat[dat[,1]>0,2]
ct1 <- gam(Y~s(X),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=3.5))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=10))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=5))
ct1 <- gam(Y~s(X),family=ocat(theta=7,link="identity",R=9))
ct1 <- gam(Y~s(X),family=ocat(theta=6,link="identity",R=9))
ct1 <- gam(Y~s(X),family=ocat(theta=5,link="identity",R=9))
ct1 <- gam(Y~s(X),family=ocat(theta=4,link="identity",R=9))
ct1 <- gam(Y~s(X),family=ocat(theta=1,link="identity",R=9))
ct1 <- gam(Y~s(X),family=ocat(theta=0,link="identity",R=9))
ct1 <- gam(Y~s(X),family=ocat(theta=0,link="identity",R=10))
ct1 <- gam(Y~s(X),family=ocat(theta=1,link="identity",R=10))
ct1 <- gam(Y~s(X),family=ocat(theta=2,link="identity",R=10))
ct1 <- gam(Y~s(X),family=ocat(theta=3,link="identity",R=10))
ct1 <- gam(Y~s(X),family=ocat(theta=5,link="identity",R=10))
ct1 <- gam(Y~s(X),family=ocat(theta=5,link="identity",R=10))
dat <- read.csv('titres.csv')
X <- dat[dat[,1]>0,1]
Y <- dat[dat[,1]>0,2]
ct1 <- gam(Y~s(X),family=ocat(theta=5,link="identity",R=10))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=10))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=19))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=9))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=4.5))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=5))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=6))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=7))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=8))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=9))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
ct1 <- gam(Y~s(X),family=ocat(theta=10,link="identity",R=9))
ct1 <- gam(Y~s(X),family=ocat(theta=1,link="identity",R=9))
ct1 <- gam(Y~s(X),family=ocat(theta=1,link="identity",R=10))
ct1 <- gam(Y~s(X),family=ocat(theta=NULL,link="identity",R=9))
predict(ct1,dat[1:2,],type="response",se=TRUE)
dat <- read.csv('titres.csv')
X <- dat[dat[,1]>0,1]
Y <- dat[dat[,1]>0,2]
ct1 <- gam(Y~s(X),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
dat <- read.csv('titres.csv')
X <- dat[dat[,1]>0,1]
Y <- dat[dat[,1]>0,2]
ct1 <- gam(Y~s(X),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
rm(list=ls())
x <- read.csv('titres.csv')
X <- x[x[,1]>0,1]
Y <- x[x[,1]>0,2]
ct1 <- gam(Y~s(X),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
x <- read.csv('netcharge.csv')
X <- x[x[,1]>0,1]
Y <- x[x[,1]>0,2]
ct1 <- gam(Y~s(X),family=Gamma(link=log))
plot(ct1,residuals=TRUE,pch=19,shade=TRUE)
library(ggplot2)
utils:::menuInstallPkgs()
library(ggplot2)
ggplot(aes(x=X,y=Y))
X
Y
melt(X,Y)
install.packages("reshape")
melt(X,Y)
melt
library('reshape')
melt
melt(X,Y)
dmelt <- melt(X,Y)
dmelt
summary(dmelt)
library(reshape2)
dmelt
dmelt <- melt(X,Y)
summary(dmelt)
value
dmelt <- melt(X,Y, id=c('age','charge'))
dmelt
X
Y
dmelt <- melt([X,Y], id=c('age','charge'))
[X Y]
c(X Y)
c(X,Y)
c(X;Y)
cbind(X,Y)
x
dmelt <- melt(x, id=c('age','charge'))
x
colnames(x) <- c("age","netcharge")
x
summary(x)
dmelt <- melt(x, id=c('age','charge'))
dmelt <- melt(x)
summary(dmelt)
d
=
read.csv
(
"http://www.nd.edu/~mclark19/learn/data/pisasci2006.csv"
d = read.csv("http://www.nd.edu/~mclark19/learn/data/pisasci2006.csv")
d = read.csv("http://www.nd.edu/~mclark19/learn/data/pisasci2006.csv")
library(psych)
install(psych)
install.package(psych)
utils:::menuInstallPkgs()
library(psych)
describe(d)
d
value
pverall
overall
library(car)
utils:::menuInstallPkgs()
librar(car)
library(car)
overall
value
dmelt = melt(d, id=c('County','Overall'), measure = c('Interest', 'Support', 'Income', 'Health', 'Edu', 'HDI'))
dmelt = melt(d, measure = c('Interest', 'Support', 'Income', 'Health', 'Edu', 'HDI'))
dmelt = melt(d,id=c('Country','Overall') measure = c('Interest', 'Support', 'Income', 'Health', 'Edu', 'HDI'))
ggplot(aes(x=value,y=Overall),data=dmelt) + geom_point(color='#FF8000',alpha=.75) + geom_text(aes(label=Country), alpha=.25) + ggtheme
dmelt = melt(d,id=c('Country','Overall'), measure = c('Interest', 'Support', 'Income', 'Health', 'Edu', 'HDI'))
ggplot(aes(x=value,y=Overall),data=dmelt) + geom_point(color='#FF8000',alpha=.75) + geom_text(aes(label=Country), alpha=.25) + ggtheme)
ggplot(aes(x=value,y=Overall),data=dmelt) + geom_point(color='#FF8000',alpha=.75) + geom_text(aes(label=Country), alpha=.25, size=1, angle=30, hjust=-.2,vjust=-.2) + facet_wrap(~variable, scales='free_x')+ggtheme
ggplot(aes(x=value,y=Overall),data=dmelt) + geom_point(color='#FF8000',alpha=.75) + geom_text(aes(label=Country), alpha=.25, size=1, angle=30, hjust=-.2,vjust=-.2) + facet_wrap(~variable, scales='free_x')
ggplot(aes(x=value,y=Overall),data=dmelt) + geom_point(color='#FF8000',alpha=.75) + geom_smooth(se=F,method='gam',formula=y-s(x),color='#2957FF') + geom_text(aes(label=Country), alpha=.25, size=1, angle=30, hjust=-.2,vjust=-.2) + facet_wrap(~variable, scales='free_x')
dmelt
ggplot(aes(x=value,y=Overall),data=dmelt) + geom_point(color='#FF8000',alpha=.75) + geom_smooth(se=F,method='gam',formula=y~s(x),color='#2957FF') + geom_text(aes(label=Country), alpha=.25, size=1, angle=30, hjust=-.2,vjust=-.2) + facet_wrap(~variable, scales='free_x')
y
se
melt
d
dmelt
dmelt
q()
