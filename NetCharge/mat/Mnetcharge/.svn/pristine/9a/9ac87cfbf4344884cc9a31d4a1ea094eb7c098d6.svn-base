% plot_13n1_noram.m
% plot the netcharge by time of isolation
% Data: AH1N1 North America 1918-2009
% Feb 12, 2012
% Hsiang-Yu Yuan

p = path
path(p,'../lib');
load('../dat/h1n1_world_1918_2007/hm_h1n1_whole_merged_data.mat');
figure;
%hold;



viruses = Viruses;
iso_index = 1; %isolation date
ngs_index = 2; %#ngs
charge_index = 3; %netcharge

    
    year_s = 1916;
    year_e = 1958;
    y_s = year_s;
    y_e = year_e;
    % Viral Strains with #NGS = 5
    
    v = viruses(find(viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    viruses_ngs = group_aa_dist_byngs(v);
    
   % ngs=4;
   % ac = viruses_ngs(find(viruses_ngs(:,ngs_index)<=ngs & viruses_ngs(:,iso_index)>y_s & viruses_ngs(:,iso_index)<y_e),:);
   % siz = length(ac(:,1));
   % for i=1:siz
   %   yr = ac(i,1);
   %   charge = ac(i,3);
   %   amount = ac(i,4);
   %   if(amount<3)
   %     plot(yr,charge,'k+', 'MarkerSize', 3);
   %   else
   %       plot(yr,charge,'k+', 'MarkerSize', 6);
   %   end
   %   hold on;
   % end
    
    
    ngs=5;
    ac = viruses_ngs(find(viruses_ngs(:,ngs_index)<=ngs & viruses_ngs(:,iso_index)>y_s & viruses_ngs(:,iso_index)<y_e),:);
    siz = length(ac(:,1));
    for i=1:siz
      yr = ac(i,1);
      charge = ac(i,3);
      amount = ac(i,4);
      if(amount<3)
        plot(yr,charge,'B+', 'MarkerSize', 3);
      else
          plot(yr,charge,'B+', 'MarkerSize', 6);
      end
      hold on;
    end
    
    %viruses_ngs = viruses(find(viruses(:,ngs_index)<=ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    %x = viruses_ngs(:,index);
    %y = viruses_ngs(:,charge_index);
    %if length(x)>0
    %plot(x,y,'Bo');
    %hold;
    %end
    
    % Viral Strains with #NGS = 6
    ngs=6;
    ac = viruses_ngs(find(viruses_ngs(:,ngs_index)==ngs & viruses_ngs(:,iso_index)>y_s & viruses_ngs(:,iso_index)<y_e),:);
    siz = length(ac(:,1));
    for i=1:siz
      yr = ac(i,1);
      charge = ac(i,3);
      amount = ac(i,4);
      if(amount<3)
        plot(yr,charge,'M+', 'MarkerSize', 3);
      else
          plot(yr,charge,'M+', 'MarkerSize', 6);
      end
      hold on;
    end
    
    %viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    %x = viruses_ngs(:,index);
    %y = viruses_ngs(:,charge_index);
    %if length(x)>0
    %plot(x,y,'Mo');
    %end
    
    % Viral Strains with #NGS = 7
    ngs=7;
    ac = viruses_ngs(find(viruses_ngs(:,ngs_index)==ngs & viruses_ngs(:,iso_index)>y_s & viruses_ngs(:,iso_index)<y_e),:);
    siz = length(ac(:,1));
    for i=1:siz
      yr = ac(i,1);
      charge = ac(i,3);
      amount = ac(i,4);
      if(amount<3)
        plot(yr,charge,'Ro', 'MarkerSize', 4);
      else
          plot(yr,charge,'Ro', 'MarkerSize', 6);
      end
      hold on;
    end
    %viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    %x = viruses_ngs(:,index);
    %y = viruses_ngs(:,charge_index);
    %if length(x)>0
    %plot(x,y,'Ro');
    %end
    
    % Viral Strains with #NGS = 8
    ngs=8;
        ac = viruses_ngs(find(viruses_ngs(:,ngs_index)==ngs & viruses_ngs(:,iso_index)>y_s & viruses_ngs(:,iso_index)<y_e),:);
    siz = length(ac(:,1));
    for i=1:siz
      yr = ac(i,1);
      charge = ac(i,3);
      amount = ac(i,4);
      if(amount<3)
        plot(yr,charge,'Gs', 'MarkerSize', 3);
      else
          plot(yr,charge,'Gs', 'MarkerSize', 6);
      end
      hold on;
    end
    
    %viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    %x = viruses_ngs(:,index);
    %y = viruses_ngs(:,charge_index);
    %if length(x)>0
    %plot(x,y,'Go');
    %end
    set(gca,'XLim',[year_s year_e]);
    
%axis([ 0, 0, 14, 20])
%year_s = 1968;
%year_e = 2010;
set(gca,'XLim',[year_s year_e])
set(gca,'YLim',[2 14]) %set the range
%x_scale = [1998 1999 2000 2001 2002 2003 2004 2005 2006];
%x_label = ['1997/1998'; '1998/1999'; '1999/2000'; '2000/2001'; '2001/2002'; '2002/2003'; '2003/2004'; '2004/2005'; '2005/2006'];
%x_label = [1998 1999 2000 2001 2002 2003 2004 2005 2006];
%set(gca,'XTick',x_scale);
%set(gca,'XTickLabel',x_label);
xlabel('Time of Isolation');
ylabel('Netcharges');
title(['A/H1N1 (1918-1957)']);

