% plot_h3n2_noram.m
% plot the netcharge by time of isolation
% Data: AH3N2 North America 1968-2012
% Feb 3, 2012
% Hsiang-Yu Yuan




load('../dat/h3n2_noram_1968_2012/hm_h3n2_noram_merged_data_1968.mat');
figure;
%hold;



viruses = Viruses;

ngs_index = 4;
index = 2; %isolation date
charge_index = 3; %netcharge
bding_index = 9; %predicted binding score
    
    year_s = 1987;
    year_e = 2010;
    y_s = year_s;
    y_e = year_e;
    
    
    
    % Viral Strains with #NGS = 6
    viruses_ngs = viruses(find(viruses(:,2)>y_s & viruses(:,2)<y_e-0.5),:);
    x = round(viruses_ngs(:,index));
    y = viruses_ngs(:,bding_index);
    plot(x,y,'Bo');
    hold;
    
    
    
    
    % Viral Strains with #NGS = 8
    ngs=8;
    viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    x = viruses_ngs(:,index);
    y = viruses_ngs(:,bding_index);
    subplot(2,2,1);
    plot(x,y,'Go');
    hold;
    x(length(x)) = [];
    y(length(y)) = [];
    X = [ones(size(x)) x]; 
    [b,bint,r,rint,stats] = regress(y,X);
    x1fit = min(x):0.1:max(x)+0.1;
    YFIT = b(1) + b(2)*x1fit;
    plot(x1fit,YFIT,'G-');
    set(gca,'XLim',[year_s year_e]);
    set(gca,'YLim',[25 45]);
    ylabel('Netcharges');
    title(['NGS=8']);
    line([1987 1987],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1990 1990],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1993 1993],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1995 1995],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1998 1998],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2001 2001],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2004 2004],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2007 2007],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2009 2009],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    
    % Viral Strains with #NGS = 9
    ngs=9;
    viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    x = viruses_ngs(:,index);
    y = viruses_ngs(:,bding_index);
    subplot(2,2,2);
    plot(x,y,'Bo');
    hold;
    X = [ones(size(x)) x]; 
    [b,bint,r,rint,stats] = regress(y,X);
    x1fit = min(x):0.1:max(x)+0.1;
    YFIT = b(1) + b(2)*x1fit;
    plot(x1fit,YFIT,'B-');
    set(gca,'XLim',[year_s year_e]);
    set(gca,'YLim',[25 45]);
    ylabel('Netcharges');
    title(['NGS=9']);
    line([1987 1987],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1990 1990],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1993 1993],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1995 1995],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1998 1998],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2001 2001],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2004 2004],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2007 2007],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2009 2009],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    
    
    % Viral Strains with #NGS = 10
    ngs=10;
    viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    x = viruses_ngs(:,index);
    y = viruses_ngs(:,bding_index);
    subplot(2,2,3);
    plot(x,y,'Co');
    hold;
    X = [ones(size(x)) x]; 
    [b,bint,r,rint,stats] = regress(y,X);
    x1fit = min(x):0.1:max(x)+0.1;
    YFIT = b(1) + b(2)*x1fit;
    plot(x1fit,YFIT,'C-');
    set(gca,'XLim',[year_s year_e]);
    set(gca,'YLim',[25 45]);
    ylabel('Netcharges');
    title(['NGS=10']);
    line([1987 1987],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1990 1990],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1993 1993],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1995 1995],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1998 1998],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2001 2001],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2004 2004],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2007 2007],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2009 2009],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    
    % Viral Strains with #NGS = 11
    ngs=11;
    viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    x = viruses_ngs(:,index);
    y = viruses_ngs(:,bding_index);
    subplot(2,2,4);
    plot(x,y,'Ko');
    hold;
    X = [ones(size(x)) x]; 
    [b,bint,r,rint,stats] = regress(y,X);
    x1fit = min(x):0.1:max(x)+0.1;
    YFIT = b(1) + b(2)*x1fit;
    plot(x1fit,YFIT,'K-');
    set(gca,'XLim',[year_s year_e]);
    set(gca,'YLim',[25 45]);
    ylabel('Netcharges');
    title(['NGS=11']);
    line([1987 1987],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1990 1990],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1993 1993],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1995 1995],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([1998 1998],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2001 2001],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2004 2004],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2007 2007],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    line([2009 2009],[12 21], 'color', [0.5 0.5 0.5], 'LineStyle', ':');
    
    % Viral Strains with #NGS = 12
    ngs=12;
    viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    x = viruses_ngs(:,index);
    y = viruses_ngs(:,bding_index);
    %subplot(2,2,4);
    %plot(x,y,'Y.');
    %set(gca,'XLim',[year_s year_e]);
    
    
    %for v=1:length(viruses(:,1))
    %    if viruses(v,ngs_index)==7
    %        plot(viruses(v,index), viruses(v,3) , 'Ro');
    %    elseif viruses(v,ngs_index)==8
    %        plot(viruses(v,index), viruses(v,3) , 'Go');
    %    elseif viruses(v,ngs_index)==9
    %        plot(viruses(v,index), viruses(v,3) , 'Bo');
    %    elseif viruses(v,ngs_index)==10
    %        plot(viruses(v,index), viruses(v,3) , 'Co');
    %    elseif viruses(v,ngs_index)==11
    %        plot(viruses(v,index), viruses(v,3) , 'Ko');
    %    elseif viruses(v,ngs_index)==12
    %        plot(viruses(v,index), viruses(v,3) , 'Yo');
    %    end
    %end
    
    
%axis([ 0, 0, 14, 20])
%year_s = 1968;
%year_e = 2010;
%set(gca,'XLim',[year_s year_e])
%set(gca,'YLim',[10 21]) %set the range
%x_scale = [1998 1999 2000 2001 2002 2003 2004 2005 2006];
%x_label = ['1997/1998'; '1998/1999'; '1999/2000'; '2000/2001'; '2001/2002'; '2002/2003'; '2003/2004'; '2004/2005'; '2005/2006'];
%x_label = [1998 1999 2000 2001 2002 2003 2004 2005 2006];
%set(gca,'XTick',x_scale);
%set(gca,'XTickLabel',x_label);
%xlabel('Time of Isolation');
%ylabel('Netcharges');
%title(['Netcharges vs Time of Isolation (NZ; ' num2str(fix(ranges2(1,1))) '-' num2str(fix(ranges2(1,2))) ')']);

