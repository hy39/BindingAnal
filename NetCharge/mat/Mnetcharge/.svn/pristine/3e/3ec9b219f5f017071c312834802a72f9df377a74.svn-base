% plot_13n1_noram.m
% plot the netcharge by time of isolation
% Data: AH1N1 North America 1918-2009
% Feb 12, 2012
% Hsiang-Yu Yuan
p = path
path(p,'../lib');
load('../dat/h1n1_world_1918_2007/hm_h1n1_whole_merged_data.mat');
figure;
%hold;



viruses = Viruses;

ngs_index = 4;
index = 2; %isolation date
charge_index = 3; %netcharge
bding_index = 9; %predicted binding avidity
    
    year_s = 1932;
    year_e = 1957;
    y_s = year_s;
    y_e = year_e;
    % Viral Strains with #NGS = 6
    ngs=5;
    viruses_ngs = viruses(find(viruses(:,ngs_index)<=ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    ac = group_aa_dist_byngs(viruses_ngs);
    
    
    
    siz = length(ac);
    %figure;
    %hold on;
    ngs=6;
    viruses_ngs = ac(find(ac(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    for i=1:siz
      yr = ac(i,1);
      charge = ac(i,3);
      amount = ac(i,4);
      if(amount<3)
        plot(yr,charge,'bo', 'MarkerSize', 2, 'MarkerFaceColor', 'b');
      elseif(amount<5)
        plot(yr,charge,'bo', 'MarkerSize', 5, 'MarkerFaceColor', 'b');
      elseif(amount<10)
           plot(yr,charge,'bo', 'MarkerSize', 7, 'MarkerFaceColor', 'b');
      else
          plot(yr,charge,'bo', 'MarkerSize', 8, 'MarkerFaceColor', 'b');
      end
      hold on;
    end
  
  
    
    
    
    x = viruses_ngs(:,index);
    y = viruses_ngs(:,bding_index);
    %subplot(2,2,1);
    if length(x)>0
    plot(x,y,'Bo');
    hold;
    set(gca,'XLim',[year_s year_e]);
    %title(['NGS=6']);
    %line([1968 1968],[8 20], 'k:');
    %line([1972 1972],[8 20], 'k:');
    %line([1975 1975],[8 20], 'k:');
    %line([1979 1979],[8 20], 'k:');
    %line([1987 1987],[8 20], 'k:');
    %line([1968 1968],[130 170], 'color', [0.9 0.9 0.9], 'LineStyle', ':');
    %line([1972 1972],[130 170], 'color', [0.9 0.9 0.9], 'LineStyle', ':');
    %line([1975 1975],[130 170], 'color', [0.9 0.9 0.9], 'LineStyle', ':');
    %line([1979 1979],[130 170], 'color', [0.9 0.9 0.9], 'LineStyle', ':');
    %line([1987 1987],[130 170], 'color', [0.9 0.9 0.9], 'LineStyle', ':');
    end
    % Viral Strains with #NGS = 6
    ngs=6;
    viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    x = viruses_ngs(:,index);
    y = viruses_ngs(:,bding_index);
    if length(x)>0
    %subplot(2,2,2);
    plot(x,y,'Mo');
    end
    
    % Viral Strains with #NGS = 7
    ngs=7;
    viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    x = viruses_ngs(:,index);
    y = viruses_ngs(:,bding_index);
    if length(x)>0
    %subplot(2,2,2);
    plot(x,y,'Ro');
    end
    
    % Viral Strains with #NGS = 8
    ngs=8;
    viruses_ngs = viruses(find(viruses(:,ngs_index)==ngs & viruses(:,2)>y_s & viruses(:,2)<y_e),:);
    x = viruses_ngs(:,index);
    y = viruses_ngs(:,bding_index);
    if length(x)>0
    %subplot(2,2,2);
    plot(x,y,'Go');
    set(gca,'XLim',[year_s year_e]);
    end
    
    
%axis([ 0, 0, 14, 20])
%year_s = 1968;
%year_e = 2010;
%set(gca,'XLim',[year_s year_e])
set(gca,'YLim',[20 38]) %set the range
%x_scale = [1998 1999 2000 2001 2002 2003 2004 2005 2006];
%x_label = ['1997/1998'; '1998/1999'; '1999/2000'; '2000/2001'; '2001/2002'; '2002/2003'; '2003/2004'; '2004/2005'; '2005/2006'];
%x_label = [1998 1999 2000 2001 2002 2003 2004 2005 2006];
%set(gca,'XTick',x_scale);
%set(gca,'XTickLabel',x_label);
xlabel('Time of Isolation');
ylabel('Netcharges');
%title(['Netcharges vs Time of Isolation (NZ; ' num2str(fix(ranges2(1,1))) '-' num2str(fix(ranges2(1,2))) ')']);

