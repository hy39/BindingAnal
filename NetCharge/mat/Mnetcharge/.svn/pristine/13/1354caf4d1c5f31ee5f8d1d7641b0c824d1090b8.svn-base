%Purpose: calculate the number of each amino acid occured in given sequences
%Parameters: None
%Input files: FASTA files downloaded from Influenza Viruses Database
%Output: 
%   1) aa_array: cell array of #amino acids for each fasta sequence
%   2) aa_charge: isolation year and net charges for each fasta sequence
%   3) aa_charge_sum: year, net charges 
function [aa_array aa_charge aa_charge_sum] = group_aa_dist(viruses)

%1)iso_year, 2)charge, 3)ngs and 4)number
aa_array = [];
ngs_index = 4;
iso_index = 2; %isolation date
charge_index = 3; %netcharge

ac = []; %year, charge, ngs, number
for i=1:length(viruses(:,1))
    v = [viruses(i,iso_index) viruses(i,ngs_index) viruses(i,charge_index)];
    ac = push_data(v);
end
aa_array = ac;
disp 'done';
function plot_aa_charge(ac)
  siz = length(ac);
  %figure;
  %hold on;
  for i=1:siz
      yr = ac(i,1);
      charge = ac(i,2);
      amount = ac(i,3);
      if(amount<5)
        plot(yr,charge,'g.', 'MarkerSize', 5);
      elseif(amount<7)
        plot(yr,charge,'g.', 'MarkerSize', 10);
      elseif(amount<15)
           plot(yr,charge,'g.', 'MarkerSize', 15);
      else
          plot(yr,charge,'g.', 'MarkerSize', 20);
      end
  hold on;
  end
end




function [ac]= push_data(v)

    for i=1:length(v)
        yr=v(i,1);
        ngs=v(i,2);
        charge=v(i,3);
        %d(i,1:5), 1=year, 2=#ngs, 3=netcharge
        %%4=#pos aas, 5=#neg aas, 6=#pos+#neg
        if isempty(ac)
            e
        loc = find(ac(:,1)==yr & ac(:,2)==charge &ac(:,3)==ngs)
        
        if(isempty(loc))
            ac = [ac; yr ngs charge 1]
        else
            ac(loc,4) = ac(loc,4) + 1;
        end
    end
    %ac(1,:) = [];
end

end


