function [] = taxa2fasta( taxa )
%function [] = taxa2fasta(taxa)
% Detailed explanation goes here
% Save all the external sequences and internal reconstructed sequences into
% FASTA file.
% output: ancestral_sequences.fas
% taxa struct:
% taxa.id = sequential ID in newick file
% taxa.name = original ID in nexus tree file
% taxa.annotation = annotation in [...]


for i =1:length(taxa)  
   Header(i) = {num2str(taxa(i).id)};
   str = taxa(i).annotation;
   pos_s = regexp(str, '="[AaGgTtCc]')+2;
   pos_e = regexp(str, '[AaGgTtCc]",');
   if (pos_s(1)>0 & pos_e(1)>pos_s(1))
       Sequence(i) = {char(str(pos_s:pos_e))};
   else
       Sequence(i) = '';
   end
end
   fastawrite(['ancestral_sequences.fas'], Header, Sequence);
   disp gofasta;
end

