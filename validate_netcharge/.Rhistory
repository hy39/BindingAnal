geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
# geom_errorbar(limits, position="dodge", width=0.25) +
ylim(16, 20)
##
## use the following code
df <- data.frame (
age = factor(c(1,2,3,4,5,6)),
highcharge = ratio,
lb = c(0.24, 0.22, 0.23, 0.21, 0.23, 0.2),
ub = c(0.18, 0.19, 0.10, 0.19, 0.11, 0.1)
)
limits <- aes(ymin=df$lb*100, ymax=df$ub*100)
ggplot(df, aes( x=age, y=highcharge*100)) +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
scale_x_discrete(breaks=c(1,2,3,4,5,6),
labels=c("0-10", "10-20", "20-40", "40-65", "65-80", ">80")) +
xlab("Age Groups") +
ylab("The Proportion of High Netcharge (%)") +
ylim(c(0, 30)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
agegroup <- c(0,2, 20,40,60,80,100)
agecode <- 0;
for (a in 1:length(Ch1[,1])) {
for (i in 1:6) {
if (Ch1[a,1] >= agegroup[i] & Ch1[a,1] < agegroup[i+1]) {
agecode[a] = i;
}
}
}
Ch1[,10] <- agecode;
#can I reset column 10?
means <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, mean)
sds <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, sd)
se <- sds[,2]
#aid = which(Ch1[,10] %in% 1)
for (i in 1:length(agegroup)-1) {
#aid <- (Ch1[,10] == i)
aid = which(Ch1[,10] %in% i)
prev <- aid[Ch1[aid,3] >= 19]
ratio[i] <- length(prev)/length(aid)
}
##-----^^^ finish above---------------
age = factor(means[,1])
netcharge = means[,2]
df <- data.frame(
age = age,
netcharge = netcharge
)
x1 <- Ch1[,10]
y1 <- Ch1[,3]
limits <- aes(ymin=netcharge-se, ymax=netcharge+se)
# R
#ggplot(aes(df, x=df$age, y=df$netcharge)) +
ggplot(df, aes(df, x=age, y=netcharge)) +
#geom_bar(position=position_dodge(), stat="identity") +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
# geom_errorbar(limits, position="dodge", width=0.25) +
ylim(16, 20)
##
## use the following code
df <- data.frame (
age = factor(c(1,2,3,4,5,6)),
highcharge = ratio,
lb = c(0.24, 0.22, 0.23, 0.21, 0.23, 0.2),
ub = c(0.18, 0.19, 0.10, 0.19, 0.11, 0.1)
)
limits <- aes(ymin=df$lb*100, ymax=df$ub*100)
ggplot(df, aes( x=age, y=highcharge*100)) +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
scale_x_discrete(breaks=c(1,2,3,4,5,6),
labels=c("0-10", "10-20", "20-40", "40-65", "65-80", ">80")) +
xlab("Age Groups") +
ylab("The Proportion of High Netcharge (%)") +
ylim(c(0, 30)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
agegroup <- c(0,20,40,60,80,100)
agecode <- 0;
for (a in 1:length(Ch1[,1])) {
for (i in 1:5) {
if (Ch1[a,1] >= agegroup[i] & Ch1[a,1] < agegroup[i+1]) {
agecode[a] = i;
}
}
}
Ch1[,10] <- agecode;
#can I reset column 10?
means <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, mean)
sds <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, sd)
se <- sds[,2]
#aid = which(Ch1[,10] %in% 1)
for (i in 1:length(agegroup)-1) {
#aid <- (Ch1[,10] == i)
aid = which(Ch1[,10] %in% i)
prev <- aid[Ch1[aid,3] >= 19]
ratio[i] <- length(prev)/length(aid)
}
##-----^^^ finish above---------------
age = factor(means[,1])
netcharge = means[,2]
df <- data.frame(
age = age,
netcharge = netcharge
)
x1 <- Ch1[,10]
y1 <- Ch1[,3]
limits <- aes(ymin=netcharge-se, ymax=netcharge+se)
# R
#ggplot(aes(df, x=df$age, y=df$netcharge)) +
ggplot(df, aes(df, x=age, y=netcharge)) +
#geom_bar(position=position_dodge(), stat="identity") +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
# geom_errorbar(limits, position="dodge", width=0.25) +
ylim(16, 20)
##
## use the following code
df <- data.frame (
age = factor(c(1,2,3,4,5,6)),
highcharge = ratio,
lb = c(0.24, 0.22, 0.23, 0.21, 0.23, 0.2),
ub = c(0.18, 0.19, 0.10, 0.19, 0.11, 0.1)
)
limits <- aes(ymin=df$lb*100, ymax=df$ub*100)
ggplot(df, aes( x=age, y=highcharge*100)) +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
scale_x_discrete(breaks=c(1,2,3,4,5,6),
labels=c("0-10", "10-20", "20-40", "40-65", "65-80", ">80")) +
xlab("Age Groups") +
ylab("The Proportion of High Netcharge (%)") +
ylim(c(0, 30)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
Ch1 <- Ch
agegroup <- c(0,20,40,60,80,100)
agecode <- 0;
for (a in 1:length(Ch1[,1])) {
for (i in 1:5) {
if (Ch1[a,1] >= agegroup[i] & Ch1[a,1] < agegroup[i+1]) {
agecode[a] = i;
}
}
}
Ch1[,10] <- agecode;
#can I reset column 10?
means <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, mean)
sds <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, sd)
se <- sds[,2]
#aid = which(Ch1[,10] %in% 1)
agesize <- 0;
for (i in 1:length(agegroup)-1) {
#aid <- (Ch1[,10] == i)
aid = which(Ch1[,10] %in% i)
prev <- aid[Ch1[aid,3] >= 19]
ratio[i] <- length(prev)/length(aid)
agesize[i] <- length(aid)
}
agesize
ratio#
ratio
Ch1 <- Ch
agegroup <- c(0,20,40,60,80,100)
agecode <- 0;
for (a in 1:length(Ch1[,1])) {
for (i in 1:5) {
if (Ch1[a,1] >= agegroup[i] & Ch1[a,1] < agegroup[i+1]) {
agecode[a] = i;
}
}
}
Ch1[,10] <- agecode;
#can I reset column 10?
means <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, mean)
sds <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, sd)
se <- sds[,2]
#aid = which(Ch1[,10] %in% 1)
ratio <- 0;
agesize <- 0;
for (i in 1:length(agegroup)-1) {
#aid <- (Ch1[,10] == i)
aid = which(Ch1[,10] %in% i)
prev <- aid[Ch1[aid,3] >= 19]
ratio[i] <- length(prev)/length(aid)
agesize[i] <- length(aid)
}
##-----^^^ finish above---------------
age = factor(means[,1])
netcharge = means[,2]
df <- data.frame(
age = age,
netcharge = netcharge
)
x1 <- Ch1[,10]
y1 <- Ch1[,3]
limits <- aes(ymin=netcharge-se, ymax=netcharge+se)
# R
#ggplot(aes(df, x=df$age, y=df$netcharge)) +
ggplot(df, aes(df, x=age, y=netcharge)) +
#geom_bar(position=position_dodge(), stat="identity") +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
# geom_errorbar(limits, position="dodge", width=0.25) +
ylim(16, 20)
##
## use the following code
df <- data.frame (
age = factor(c(1,2,3,4,5)),
highcharge = ratio,
lb = c(0.1018,  0.0751,    0.0484,    0.1834,    0.1874),
ub = c(0.1858,  0.1853,    0.1732,    0.3417,    0.3216)
)
limits <- aes(ymin=df$lb*100, ymax=df$ub*100)
ggplot(df, aes( x=age, y=highcharge*100)) +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
scale_x_discrete(breaks=c(1,2,3,4,5,6),
labels=c("0-10", "10-20", "20-40", "40-65", "65-80", ">80")) +
xlab("Age Groups") +
ylab("The Proportion of High Netcharge (%)") +
ylim(c(0, 30)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
ratio
ublist
agegroup <- c(0,20,40,60,80,100)
agecode <- 0;
for (a in 1:length(Ch1[,1])) {
for (i in 1:5) {
if (Ch1[a,1] >= agegroup[i] & Ch1[a,1] < agegroup[i+1]) {
agecode[a] = i;
}
}
}
Ch1[,10] <- agecode;
#can I reset column 10?
means <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, mean)
sds <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, sd)
se <- sds[,2]
#aid = which(Ch1[,10] %in% 1)
ratio <- 0;
agesize <- 0;
for (i in 1:length(agegroup)-1) {
#aid <- (Ch1[,10] == i)
aid = which(Ch1[,10] %in% i)
prev <- aid[Ch1[aid,3] >= 19]
ratio[i] <- length(prev)/length(aid)
agesize[i] <- length(aid)
}
##-----^^^ finish above---------------
age = factor(means[,1])
netcharge = means[,2]
df <- data.frame(
age = age,
netcharge = netcharge
)
x1 <- Ch1[,10]
y1 <- Ch1[,3]
limits <- aes(ymin=netcharge-se, ymax=netcharge+se)
# R
#ggplot(aes(df, x=df$age, y=df$netcharge)) +
ggplot(df, aes(df, x=age, y=netcharge)) +
#geom_bar(position=position_dodge(), stat="identity") +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
# geom_errorbar(limits, position="dodge", width=0.25) +
ylim(16, 20)
##
## use the following code
df <- data.frame (
age = factor(c(1,2,3,4,5)),
highcharge = ratio,
lb = c(0.1018,  0.0751,    0.0484,    0.1834,    0.1874),
ub = c(0.1858,  0.1853,    0.1732,    0.3417,    0.3216)
)
limits <- aes(ymin=df$lb*100, ymax=df$ub*100)
ggplot(df, aes( x=age, y=highcharge*100)) +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
scale_x_discrete(breaks=c(1,2,3,4,5),
labels=c("0-20", "20-40", "40-60", "60-80", ">80")) +
xlab("Age Groups") +
ylab("The Proportion of High Netcharge (%)") +
ylim(c(0, 30)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
limits <- aes(ymin=df$lb*100, ymax=df$ub*100)
limits
df$lb
df$ub
df$age
ggplot(df, aes( x=age, y=highcharge*100)) +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25)
ggplot(df, aes( x=age, y=highcharge*100)) +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
scale_x_discrete(breaks=c(1,2,3,4,5),
labels=c("0-20", "20-40", "40-60", "60-80", ">80")) +
xlab("Age Groups") +
ylab("The Proportion of High Netcharge (%)") +
ylim(c(0, 40))
ggplot(df, aes( x=age, y=highcharge*100)) +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
scale_x_discrete(breaks=c(1,2,3,4,5),
labels=c("0-20", "20-40", "40-60", "60-80", ">80")) +
xlab("Age Groups") +
ylab("The Proportion of High Netcharge (%)") +
ylim(c(0, 40)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
ggplot(df, aes( x=age, y=highcharge*100)) +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
scale_x_discrete(breaks=c(1,2,3,4,5),
labels=c("0-20", "20-40", "40-60", "60-80", ">80")) +
xlab("Age Groups") +
ylab("The Proportion of Netcharge >18 (%)") +
ylim(c(0, 40)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
plot_bindingchanges
setwd("E:/Documents/Github/BindingAnal/validate_netcharge")
#M <- read.csv('RDE/MOthers.dat')
M <- read.csv('RDE/MTotal.dat')
#M <- read.csv('dat_netch_bindn.csv')
#Mnew <- read.csv('Mnewlist.dat')
# calculate the mean
means <- aggregate(M[,4] ~  M[,5], M, mean)
# plot the netcharge data
ggplot(M,aes(factor(M[,5]), M[,4])) +
#scale_size_area() +
xlab('Netcharge Changes') +
ylab('The Ratio of Cell Binding (log scale)') +
geom_boxplot(outlier.colour=NA) +
geom_jitter(width=.5, height=0, size=2) +
stat_summary(fun.y=mean, colour="darkred", geom="point", shape=1, size=3, show.legend = FALSE) +
scale_x_discrete(breaks=c(-1, 0, 1), labels=c("Decreased", "Same", "Increased")) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
# anova for netcharge
fm1 <- aov(M[,4] ~ M[,5])
anova(fm1)
M <- read.csv('RDE/MTotal.dat')
#M <- read.csv('dat_netch_bindn.csv')
#Mnew <- read.csv('Mnewlist.dat')
# calculate the mean
means <- aggregate(M[,4] ~  M[,5], M, mean)
# plot the netcharge data
ggplot(M,aes(factor(M[,5]), M[,4])) +
#scale_size_area() +
xlab('Changes of the netcharge') +
ylab('The ratio of Cellular Binding (log scale)') +
geom_boxplot(outlier.colour=NA) +
geom_jitter(width=.5, height=0, size=2) +
stat_summary(fun.y=mean, colour="darkred", geom="point", shape=1, size=3, show.legend = FALSE) +
scale_x_discrete(breaks=c(-1, 0, 1), labels=c("Decreased", "Same", "Increased")) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
# anova for netcharge
fm1 <- aov(M[,4] ~ M[,5])
anova(fm1)
M <- read.csv('RDE/MTotal.dat')
#M <- read.csv('dat_netch_bindn.csv')
#Mnew <- read.csv('Mnewlist.dat')
# calculate the mean
means <- aggregate(M[,4] ~  M[,5], M, mean)
# plot the netcharge data
ggplot(M,aes(factor(M[,5]), M[,4])) +
#scale_size_area() +
xlab('Changes of the netcharge') +
ylab('The ratio of Cellular Binding (log scale)') +
geom_boxplot(outlier.colour=NA) +
geom_jitter(width=.5, height=0, size=2) +
stat_summary(fun.y=mean, colour="darkred", geom="point", shape=1, size=3, show.legend = FALSE) +
scale_x_discrete(breaks=c(-1, 0, 1), labels=c("Decrease", "Same", "Increase")) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
# anova for netcharge
fm1 <- aov(M[,4] ~ M[,5])
anova(fm1)
M <- read.csv('RDE/MTotal.dat')
#M <- read.csv('dat_netch_bindn.csv')
#Mnew <- read.csv('Mnewlist.dat')
# calculate the mean
means <- aggregate(M[,4] ~  M[,5], M, mean)
# plot the netcharge data
ggplot(M,aes(factor(M[,5]), M[,4])) +
#scale_size_area() +
xlab('Changes of the net charge') +
ylab('The ratio of Cellular Binding (log scale)') +
geom_boxplot(outlier.colour=NA) +
geom_jitter(width=.5, height=0, size=2) +
stat_summary(fun.y=mean, colour="darkred", geom="point", shape=1, size=3, show.legend = FALSE) +
scale_x_discrete(breaks=c(-1, 0, 1), labels=c("Decrease", "Same", "Increase")) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
# anova for netcharge
fm1 <- aov(M[,4] ~ M[,5])
anova(fm1)
M <- read.csv('RDE/abs_charge.csv')
plot(M$abs_netcharge, M$abs_binding, xaxt = "n", xlab = "Netcharge",
ylab = "Binding avidity (fold)")
axis(1, at=-2:2, labels=16:20)
reg1 <- lm(M$abs_netcharge~M$abs_binding)
abline(reg1) +
ylim(c(0, 80)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
summary(reg1)
M <- read.csv('RDE/abs_charge.csv')
plot(M$abs_netcharge, M$abs_binding, xaxt = "n", xlab = "Net charge",
ylab = "Relative binding avidity (log scale)")
axis(1, at=-2:2, labels=16:20)
reg1 <- lm(M$abs_netcharge~M$abs_binding)
abline(reg1) +
ylim(c(0, 80)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
summary(reg1)
M <- read.csv('RDE/MTotal.dat')
#M <- read.csv('dat_netch_bindn.csv')
#Mnew <- read.csv('Mnewlist.dat')
# calculate the mean
means <- aggregate(M[,4] ~  M[,5], M, mean)
# plot the netcharge data
ggplot(M,aes(factor(M[,5]), M[,4])) +
#scale_size_area() +
xlab('Changes of the net charge') +
ylab('The relative binding avidity (log scale)') +
geom_boxplot(outlier.colour=NA) +
geom_jitter(width=.5, height=0, size=2) +
stat_summary(fun.y=mean, colour="darkred", geom="point", shape=1, size=3, show.legend = FALSE) +
scale_x_discrete(breaks=c(-1, 0, 1), labels=c("Decrease", "Same", "Increase")) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
# anova for netcharge
fm1 <- aov(M[,4] ~ M[,5])
anova(fm1)
M <- read.csv('RDE/abs_charge.csv')
plot(M$abs_netcharge, M$abs_binding, xaxt = "n", color="darkred", xlab = "Net charge",
ylab = "Relative binding avidity (log scale)")
M <- read.csv('RDE/abs_charge.csv')
plot(M$abs_netcharge, M$abs_binding, xaxt = "n", xlab = "Net charge",
ylab = "Relative binding avidity (log scale)")
axis(1, at=-2:2, labels=16:20)
reg1 <- lm(M$abs_netcharge~M$abs_binding)
abline(reg1) +
ylim(c(0, 80)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
summary(reg1)
Ch <- read.csv('Chlist.dat')
#Ch1 <- Ch[which(Ch[,4]==10),]
Ch1 <- Ch
agegroup <- c(0,20,40,60,80,100)
agecode <- 0;
for (a in 1:length(Ch1[,1])) {
for (i in 1:5) {
if (Ch1[a,1] >= agegroup[i] & Ch1[a,1] < agegroup[i+1]) {
agecode[a] = i;
}
}
}
Ch1[,10] <- agecode;
#can I reset column 10?
means <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, mean)
sds <- aggregate(Ch1[,3] ~  Ch1[,10], Ch1, sd)
se <- sds[,2]
#aid = which(Ch1[,10] %in% 1)
ratio <- 0;
agesize <- 0;
for (i in 1:length(agegroup)-1) {
#aid <- (Ch1[,10] == i)
aid = which(Ch1[,10] %in% i)
prev <- aid[Ch1[aid,3] >= 19]
ratio[i] <- length(prev)/length(aid)
agesize[i] <- length(aid)
}
##-----^^^ finish above---------------
age = factor(means[,1])
netcharge = means[,2]
df <- data.frame(
age = age,
netcharge = netcharge
)
x1 <- Ch1[,10]
y1 <- Ch1[,3]
limits <- aes(ymin=netcharge-se, ymax=netcharge+se)
# R
#ggplot(aes(df, x=df$age, y=df$netcharge)) +
ggplot(df, aes(df, x=age, y=netcharge)) +
#geom_bar(position=position_dodge(), stat="identity") +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
# geom_errorbar(limits, position="dodge", width=0.25) +
ylim(16, 20)
##
## use the following code
df <- data.frame (
age = factor(c(1,2,3,4,5)),
highcharge = ratio,
lb = c(0.1018,  0.0751,    0.0484,    0.1834,    0.1874),
ub = c(0.1858,  0.1853,    0.1732,    0.3417,    0.3216)
)
limits <- aes(ymin=df$lb*100, ymax=df$ub*100)
ggplot(df, aes( x=age, y=highcharge*100)) +
geom_point(size = 5) +
geom_errorbar(limits, width=0.25) +
scale_x_discrete(breaks=c(1,2,3,4,5),
labels=c("0-20", "20-40", "40-60", "60-80", ">80")) +
xlab("Age Groups") +
ylab("The Proportion of Netcharge >18 (%)") +
ylim(c(0, 40)) +
theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold"))
x <- seq(1, 120, 10)
y <- seq(0, 10, length=101)
f <- function(x, y) { r <- sqrt(x^2+y^2); 10 * sin(r)/r }
z <- outer(x, y, f)
plot(x,y,z)
plot(x,y)
